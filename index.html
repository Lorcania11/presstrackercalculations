<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3-Team Press Logic: Complete Spreadsheet Analysis</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f7fa;
            min-height: 100vh;
            padding: 20px;
        }
        
        .spreadsheet-container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .spreadsheet-header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 20px 30px;
            text-align: center;
        }
        
        .spreadsheet-header h1 {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .spreadsheet-header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }
        
        .tabs {
            display: flex;
            background: #e9ecef;
            border-bottom: 2px solid #dee2e6;
            overflow-x: auto;
        }
        
        .tab {
            padding: 15px 25px;
            background: #e9ecef;
            border: none;
            cursor: pointer;
            font-weight: 600;
            color: #495057;
            border-right: 1px solid #dee2e6;
            white-space: nowrap;
            transition: all 0.2s ease;
        }
        
        .tab:hover {
            background: #d1ecf1;
        }
        
        .tab.active {
            background: white;
            color: #1e3c72;
            border-bottom: 3px solid #1e3c72;
        }
        
        .tab-content {
            display: none;
            padding: 30px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .sheet-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border: 2px solid #dee2e6;
        }
        
        .sheet-table th {
            background: #1e3c72;
            color: white;
            padding: 12px 8px;
            text-align: center;
            font-weight: 600;
            border: 1px solid #495057;
            font-size: 0.9rem;
        }
        
        .sheet-table td {
            padding: 10px 8px;
            border: 1px solid #dee2e6;
            text-align: center;
            font-size: 0.85rem;
        }
        
        .sheet-table tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        .formula-cell {
            background: #e8f5e8 !important;
            font-family: 'Courier New', monospace;
            font-weight: bold;
        }
        
        .result-cell {
            background: #fff3cd !important;
            font-weight: bold;
            color: #856404;
        }
        
        .header-cell {
            background: #d1ecf1 !important;
            font-weight: bold;
            color: #0c5460;
        }
        
        .team1-cell { background: #d4edda !important; color: #155724; }
        .team2-cell { background: #fff3cd !important; color: #856404; }
        .team3-cell { background: #f8d7da !important; color: #721c24; }
        
        .section-header {
            background: #1e3c72;
            color: white;
            padding: 15px;
            margin: 30px 0 15px 0;
            border-radius: 8px;
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .calculation-box {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .calculation-title {
            font-weight: bold;
            color: #1e3c72;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        
        .step-list {
            list-style: none;
            margin: 15px 0;
        }
        
        .step-list li {
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        
        .step-list li:before {
            content: "→ ";
            color: #1e3c72;
            font-weight: bold;
        }
        
        .highlight-yellow { background: #fff3cd !important; }
        .highlight-green { background: #d4edda !important; }
        .highlight-blue { background: #d1ecf1 !important; }
        .highlight-red { background: #f8d7da !important; }
        
        .matrix-container {
            overflow-x: auto;
            margin: 20px 0;
        }
        
        .small-table {
            font-size: 0.8rem;
        }
        
        .small-table th,
        .small-table td {
            padding: 6px 4px;
        }
        
        .note-box {
            background: #d1ecf1;
            border-left: 4px solid #1e3c72;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        
        .note-box h4 {
            color: #1e3c72;
            margin-bottom: 10px;
        }
        
        .export-btn {
            background: #28a745;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            margin: 10px 5px;
            transition: all 0.2s ease;
        }
        
        .export-btn:hover {
            background: #218838;
            transform: translateY(-1px);
        }
        
        .scenario-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .scenario-card {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
        }
        
        .scenario-card h4 {
            color: #1e3c72;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="spreadsheet-container">
        <div class="spreadsheet-header">
            <h1>📊 3-Team Press Logic: Complete Spreadsheet Analysis</h1>
            <p>Comprehensive mathematical breakdown with detailed calculations and scenarios</p>
            <div style="margin-top: 15px;">
                <button class="export-btn" onclick="exportToCSV()">📄 Export to CSV</button>
                <button class="export-btn" onclick="exportToExcel()">📗 Export to Excel</button>
            </div>
        </div>
        
        <div class="tabs">
            <button class="tab active" onclick="openTab(event, 'summary')">Summary</button>
            <button class="tab" onclick="openTab(event, 'relationships')">Team Relationships</button>
            <button class="tab" onclick="openTab(event, 'scenarios')">Game Scenarios</button>
            <button class="tab" onclick="openTab(event, 'calculations')">Detailed Calculations</button>
            <button class="tab" onclick="openTab(event, 'eligibility')">Press Eligibility Logic</button>
            <button class="tab" onclick="openTab(event, 'examples')">Example Situations</button>
            <button class="tab" onclick="openTab(event, 'implementation')">Implementation Matrix</button>
        </div>
        
        <!-- Summary Tab -->
        <div id="summary" class="tab-content active">
            <div class="section-header">📋 Executive Summary</div>
            
            <table class="sheet-table">
                <thead>
                    <tr>
                        <th>Game Selection Scenario</th>
                        <th>Team Relationships</th>
                        <th>Number of Games</th>
                        <th>Calculation Formula</th>
                        <th>Total Combinations</th>
                        <th>Overlap Type</th>
                        <th>Complexity Level</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Single Game Only</td>
                        <td>6</td>
                        <td>1</td>
                        <td class="formula-cell">6 × 1</td>
                        <td class="result-cell">6</td>
                        <td>None</td>
                        <td>Low</td>
                    </tr>
                    <tr>
                        <td>Front 9 + Back 9</td>
                        <td>6</td>
                        <td>2</td>
                        <td class="formula-cell">6 × 2</td>
                        <td class="result-cell">12</td>
                        <td>None</td>
                        <td>Medium</td>
                    </tr>
                    <tr>
                        <td>Front 9 + Total 18</td>
                        <td>6</td>
                        <td>2</td>
                        <td class="formula-cell">6 × 2</td>
                        <td class="result-cell">12</td>
                        <td>Holes 1-9 Overlap</td>
                        <td>High</td>
                    </tr>
                    <tr>
                        <td>Back 9 + Total 18</td>
                        <td>6</td>
                        <td>2</td>
                        <td class="formula-cell">6 × 2</td>
                        <td class="result-cell">12</td>
                        <td>Holes 10-18 Overlap</td>
                        <td>High</td>
                    </tr>
                    <tr>
                        <td>All Three Games</td>
                        <td>6</td>
                        <td>3</td>
                        <td class="formula-cell">6 × 3</td>
                        <td class="result-cell">18</td>
                        <td>Full Overlap</td>
                        <td>Maximum</td>
                    </tr>
                </tbody>
            </table>
            
            <div class="calculation-box">
                <div class="calculation-title">📐 Core Formula Explanation</div>
                <ul class="step-list">
                    <li><strong>Team Relationships:</strong> 3 teams → Each team can press 2 others → 3 × 2 = 6 directed relationships</li>
                    <li><strong>Game Types:</strong> Front 9, Back 9, Total 18 (up to 3 possible selections)</li>
                    <li><strong>Total Combinations:</strong> Team Relationships × Selected Game Types</li>
                    <li><strong>Overlap Impact:</strong> Doesn't change combinations, but increases logic complexity</li>
                </ul>
            </div>
        </div>
        
        <!-- Team Relationships Tab -->
        <div id="relationships" class="tab-content">
            <div class="section-header">🔗 Team Relationship Matrix</div>
            
            <div class="calculation-box">
                <div class="calculation-title">6 Directed Team Relationships (Pressing Team → Target Team)</div>
            </div>
            
            <table class="sheet-table">
                <thead>
                    <tr>
                        <th>Relationship ID</th>
                        <th>Pressing Team</th>
                        <th>Target Team</th>
                        <th>Relationship Code</th>
                        <th>Color Coding</th>
                        <th>Notes</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>R1</td>
                        <td class="team1-cell">Team 1 (Green)</td>
                        <td class="team2-cell">Team 2 (Orange)</td>
                        <td class="formula-cell">T1→T2</td>
                        <td>Green → Orange</td>
                        <td>Team 1 pressing Team 2</td>
                    </tr>
                    <tr>
                        <td>R2</td>
                        <td class="team1-cell">Team 1 (Green)</td>
                        <td class="team3-cell">Team 3 (Red)</td>
                        <td class="formula-cell">T1→T3</td>
                        <td>Green → Red</td>
                        <td>Team 1 pressing Team 3</td>
                    </tr>
                    <tr>
                        <td>R3</td>
                        <td class="team2-cell">Team 2 (Orange)</td>
                        <td class="team1-cell">Team 1 (Green)</td>
                        <td class="formula-cell">T2→T1</td>
                        <td>Orange → Green</td>
                        <td>Team 2 pressing Team 1</td>
                    </tr>
                    <tr>
                        <td>R4</td>
                        <td class="team2-cell">Team 2 (Orange)</td>
                        <td class="team3-cell">Team 3 (Red)</td>
                        <td class="formula-cell">T2→T3</td>
                        <td>Orange → Red</td>
                        <td>Team 2 pressing Team 3</td>
                    </tr>
                    <tr>
                        <td>R5</td>
                        <td class="team3-cell">Team 3 (Red)</td>
                        <td class="team1-cell">Team 1 (Green)</td>
                        <td class="formula-cell">T3→T1</td>
                        <td>Red → Green</td>
                        <td>Team 3 pressing Team 1</td>
                    </tr>
                    <tr>
                        <td>R6</td>
                        <td class="team3-cell">Team 3 (Red)</td>
                        <td class="team2-cell">Team 2 (Orange)</td>
                        <td class="formula-cell">T3→T2</td>
                        <td>Red → Orange</td>
                        <td>Team 3 pressing Team 2</td>
                    </tr>
                </tbody>
            </table>
            
            <div class="note-box">
                <h4>Important Notes:</h4>
                <ul>
                    <li><strong>Directional:</strong> T1→T2 ≠ T2→T1 (different pressing scenarios)</li>
                    <li><strong>Point of View:</strong> Each relationship tracks status from pressing team's perspective</li>
                    <li><strong>Simultaneous:</strong> Multiple relationships can be active at once</li>
                </ul>
            </div>
        </div>
        
        <!-- Game Scenarios Tab -->
        <div id="scenarios" class="tab-content">
            <div class="section-header">🎯 Complete Game Type Scenarios</div>
            
            <div class="scenario-grid">
                <div class="scenario-card">
                    <h4>Scenario 1: Single Game Selection</h4>
                    <table class="sheet-table small-table">
                        <tr><th>Game</th><th>Hole Range</th><th>Combinations</th></tr>
                        <tr><td>Front 9 Only</td><td>1-9</td><td class="result-cell">6</td></tr>
                        <tr><td>Back 9 Only</td><td>10-18</td><td class="result-cell">6</td></tr>
                        <tr><td>Total 18 Only</td><td>1-18</td><td class="result-cell">6</td></tr>
                    </table>
                </div>
                
                <div class="scenario-card">
                    <h4>Scenario 2: Two Games - No Overlap</h4>
                    <table class="sheet-table small-table">
                        <tr><th>Games</th><th>Hole Ranges</th><th>Combinations</th></tr>
                        <tr><td>Front + Back</td><td>1-9, 10-18</td><td class="result-cell">12</td></tr>
                    </table>
                    <p><strong>Calculation:</strong> 6 relationships × 2 games = 12</p>
                </div>
                
                <div class="scenario-card">
                    <h4>Scenario 3: Two Games - With Overlap</h4>
                    <table class="sheet-table small-table">
                        <tr><th>Games</th><th>Overlap Holes</th><th>Combinations</th></tr>
                        <tr><td>Front + Total</td><td>1-9</td><td class="result-cell">12</td></tr>
                        <tr><td>Back + Total</td><td>10-18</td><td class="result-cell">12</td></tr>
                    </table>
                    <p><strong>Calculation:</strong> 6 relationships × 2 games = 12</p>
                </div>
                
                <div class="scenario-card">
                    <h4>Scenario 4: All Three Games</h4>
                    <table class="sheet-table small-table">
                        <tr><th>Games</th><th>All Ranges</th><th>Combinations</th></tr>
                        <tr><td>Front + Back + Total</td><td>1-9, 10-18, 1-18</td><td class="result-cell">18</td></tr>
                    </table>
                    <p><strong>Calculation:</strong> 6 relationships × 3 games = 18</p>
                </div>
            </div>
            
            <div class="section-header">🔍 Detailed Breakdown: All Three Games Scenario</div>
            
            <table class="sheet-table">
                <thead>
                    <tr>
                        <th>Combination ID</th>
                        <th>Pressing Team</th>
                        <th>Target Team</th>
                        <th>Game Type</th>
                        <th>Hole Range</th>
                        <th>Overlap with Other Games</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>C1</td><td class="team1-cell">Team 1</td><td class="team2-cell">Team 2</td><td>Front 9</td><td>1-9</td><td class="highlight-yellow">Overlaps with Total 18</td></tr>
                    <tr><td>C2</td><td class="team1-cell">Team 1</td><td class="team2-cell">Team 2</td><td>Back 9</td><td>10-18</td><td class="highlight-yellow">Overlaps with Total 18</td></tr>
                    <tr><td>C3</td><td class="team1-cell">Team 1</td><td class="team2-cell">Team 2</td><td>Total 18</td><td>1-18</td><td class="highlight-red">Overlaps with Front & Back</td></tr>
                    <tr><td>C4</td><td class="team1-cell">Team 1</td><td class="team3-cell">Team 3</td><td>Front 9</td><td>1-9</td><td class="highlight-yellow">Overlaps with Total 18</td></tr>
                    <tr><td>C5</td><td class="team1-cell">Team 1</td><td class="team3-cell">Team 3</td><td>Back 9</td><td>10-18</td><td class="highlight-yellow">Overlaps with Total 18</td></tr>
                    <tr><td>C6</td><td class="team1-cell">Team 1</td><td class="team3-cell">Team 3</td><td>Total 18</td><td>1-18</td><td class="highlight-red">Overlaps with Front & Back</td></tr>
                    <tr><td>C7</td><td class="team2-cell">Team 2</td><td class="team1-cell">Team 1</td><td>Front 9</td><td>1-9</td><td class="highlight-yellow">Overlaps with Total 18</td></tr>
                    <tr><td>C8</td><td class="team2-cell">Team 2</td><td class="team1-cell">Team 1</td><td>Back 9</td><td>10-18</td><td class="highlight-yellow">Overlaps with Total 18</td></tr>
                    <tr><td>C9</td><td class="team2-cell">Team 2</td><td class="team1-cell">Team 1</td><td>Total 18</td><td>1-18</td><td class="highlight-red">Overlaps with Front & Back</td></tr>
                    <tr><td>C10</td><td class="team2-cell">Team 2</td><td class="team3-cell">Team 3</td><td>Front 9</td><td>1-9</td><td class="highlight-yellow">Overlaps with Total 18</td></tr>
                    <tr><td>C11</td><td class="team2-cell">Team 2</td><td class="team3-cell">Team 3</td><td>Back 9</td><td>10-18</td><td class="highlight-yellow">Overlaps with Total 18</td></tr>
                    <tr><td>C12</td><td class="team2-cell">Team 2</td><td class="team3-cell">Team 3</td><td>Total 18</td><td>1-18</td><td class="highlight-red">Overlaps with Front & Back</td></tr>
                    <tr><td>C13</td><td class="team3-cell">Team 3</td><td class="team1-cell">Team 1</td><td>Front 9</td><td>1-9</td><td class="highlight-yellow">Overlaps with Total 18</td></tr>
                    <tr><td>C14</td><td class="team3-cell">Team 3</td><td class="team1-cell">Team 1</td><td>Back 9</td><td>10-18</td><td class="highlight-yellow">Overlaps with Total 18</td></tr>
                    <tr><td>C15</td><td class="team3-cell">Team 3</td><td class="team1-cell">Team 1</td><td>Total 18</td><td>1-18</td><td class="highlight-red">Overlaps with Front & Back</td></tr>
                    <tr><td>C16</td><td class="team3-cell">Team 3</td><td class="team2-cell">Team 2</td><td>Front 9</td><td>1-9</td><td class="highlight-yellow">Overlaps with Total 18</td></tr>
                    <tr><td>C17</td><td class="team3-cell">Team 3</td><td class="team2-cell">Team 2</td><td>Back 9</td><td>10-18</td><td class="highlight-yellow">Overlaps with Total 18</td></tr>
                    <tr><td>C18</td><td class="team3-cell">Team 3</td><td class="team2-cell">Team 2</td><td>Total 18</td><td>1-18</td><td class="highlight-red">Overlaps with Front & Back</td></tr>
                </tbody>
            </table>
        </div>
        
        <!-- Detailed Calculations Tab -->
        <div id="calculations" class="tab-content">
            <div class="section-header">🧮 Step-by-Step Calculations</div>
            
            <div class="calculation-box">
                <div class="calculation-title">Calculation 1: Base Team Relationships</div>
                <ul class="step-list">
                    <li><strong>Step 1:</strong> Count total teams = 3</li>
                    <li><strong>Step 2:</strong> Each team can press other teams = 3 - 1 = 2 targets per team</li>
                    <li><strong>Step 3:</strong> Total directed relationships = 3 teams × 2 targets = 6 relationships</li>
                    <li><strong>Result:</strong> 6 unique pressing relationships (T1→T2, T1→T3, T2→T1, T2→T3, T3→T1, T3→T2)</li>
                </ul>
            </div>
            
            <div class="calculation-box">
                <div class="calculation-title">Calculation 2: Single Game Scenario</div>
                <ul class="step-list">
                    <li><strong>Given:</strong> 6 team relationships, 1 game type selected</li>
                    <li><strong>Formula:</strong> Total Combinations = Relationships × Games</li>
                    <li><strong>Calculation:</strong> 6 × 1 = 6</li>
                    <li><strong>Example:</strong> If only "Front 9" selected, each of 6 relationships can create 1 press on Front 9</li>
                </ul>
            </div>
            
            <div class="calculation-box">
                <div class="calculation-title">Calculation 3: Two Games - Non-Overlapping (Front + Back)</div>
                <ul class="step-list">
                    <li><strong>Given:</strong> 6 team relationships, 2 game types (Front 9: holes 1-9, Back 9: holes 10-18)</li>
                    <li><strong>Formula:</strong> Total Combinations = Relationships × Games</li>
                    <li><strong>Calculation:</strong> 6 × 2 = 12</li>
                    <li><strong>Breakdown:</strong> Each relationship can create 2 presses (1 on Front 9, 1 on Back 9)</li>
                    <li><strong>No Overlap:</strong> Front 9 and Back 9 use completely different holes</li>
                </ul>
            </div>
            
            <div class="calculation-box">
                <div class="calculation-title">Calculation 4: Two Games - Overlapping (Front + Total)</div>
                <ul class="step-list">
                    <li><strong>Given:</strong> 6 team relationships, 2 game types (Front 9: holes 1-9, Total 18: holes 1-18)</li>
                    <li><strong>Formula:</strong> Total Combinations = Relationships × Games</li>
                    <li><strong>Calculation:</strong> 6 × 2 = 12</li>
                    <li><strong>Overlap:</strong> Holes 1-9 count for BOTH Front 9 and Total 18 games</li>
                    <li><strong>Complexity:</strong> A press on hole 5 affects both Front 9 and Total 18 calculations</li>
                </ul>
            </div>
            
            <div class="calculation-box">
                <div class="calculation-title">Calculation 5: All Three Games (Maximum Complexity)</div>
                <ul class="step-list">
                    <li><strong>Given:</strong> 6 team relationships, 3 game types (Front 9, Back 9, Total 18)</li>
                    <li><strong>Formula:</strong> Total Combinations = Relationships × Games</li>
                    <li><strong>Calculation:</strong> 6 × 3 = 18</li>
                    <li><strong>Maximum Overlap:</strong> Total 18 overlaps with both Front 9 and Back 9</li>
                    <li><strong>Potential Active Presses:</strong> Up to 18 simultaneous presses possible</li>
                </ul>
            </div>
            
            <div class="section-header">📊 Validation Table</div>
            
            <table class="sheet-table">
                <thead>
                    <tr>
                        <th>Scenario</th>
                        <th>Your Original Calculation</th>
                        <th>Correct Calculation</th>
                        <th>Difference</th>
                        <th>Error Explanation</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Single Game</td>
                        <td class="highlight-green">6</td>
                        <td class="highlight-green">6</td>
                        <td>0</td>
                        <td>✅ Correct</td>
                    </tr>
                    <tr>
                        <td>Front + Back</td>
                        <td class="highlight-green">12</td>
                        <td class="highlight-green">12</td>
                        <td>0</td>
                        <td>✅ Correct</td>
                    </tr>
                    <tr>
                        <td>Front + Total</td>
                        <td class="highlight-red">18</td>
                        <td class="highlight-yellow">12</td>
                        <td>-6</td>
                        <td>❌ Overcounted overlap complexity</td>
                    </tr>
                    <tr>
                        <td>Back + Total</td>
                        <td class="highlight-red">18</td>
                        <td class="highlight-yellow">12</td>
                        <td>-6</td>
                        <td>❌ Overcounted overlap complexity</td>
                    </tr>
                    <tr>
                        <td>All Three</td>
                        <td class="highlight-red">30</td>
                        <td class="highlight-yellow">18</td>
                        <td>-12</td>
                        <td>❌ Confused overlap with additional combinations</td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <!-- Press Eligibility Logic Tab -->
        <div id="eligibility" class="tab-content">
            <div class="section-header">🎯 Press Eligibility Logic Matrix</div>
            
            <div class="note-box">
                <h4>Press Eligibility Rules (Match Play):</h4>
                <ul>
                    <li>Team must be DOWN by 2+ holes to be eligible to press</li>
                    <li>Each game type (Front 9, Back 9, Total 18) calculated independently</li>
                    <li>Can press different targets on different game types simultaneously</li>
                </ul>
            </div>
            
            <table class="sheet-table">
                <thead>
                    <tr>
                        <th rowspan="2">Pressing Team</th>
                        <th colspan="3">vs Team 1</th>
                        <th colspan="3">vs Team 2</th>
                        <th colspan="3">vs Team 3</th>
                    </tr>
                    <tr>
                        <th>Front 9</th>
                        <th>Back 9</th>
                        <th>Total 18</th>
                        <th>Front 9</th>
                        <th>Back 9</th>
                        <th>Total 18</th>
                        <th>Front 9</th>
                        <th>Back 9</th>
                        <th>Total 18</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="header-cell">Team 1</td>
                        <td>—</td>
                        <td>—</td>
                        <td>—</td>
                        <td class="highlight-green">Available</td>
                        <td class="highlight-red">Not Available</td>
                        <td class="highlight-green">Available</td>
                        <td class="highlight-red">Not Available</td>
                        <td class="highlight-green">Available</td>
                        <td class="highlight-red">Not Available</td>
                    </tr>
                    <tr>
                        <td class="header-cell">Team 2</td>
                        <td class="highlight-red">Not Available</td>
                        <td class="highlight-green">Available</td>
                        <td class="highlight-red">Not Available</td>
                        <td>—</td>
                        <td>—</td>
                        <td>—</td>
                        <td class="highlight-red">Not Available</td>
                        <td class="highlight-red">Not Available</td>
                        <td class="highlight-green">Available</td>
                    </tr>
                    <tr>
                        <td class="header-cell">Team 3</td>
                        <td class="highlight-green">Available</td>
                        <td class="highlight-red">Not Available</td>
                        <td class="highlight-green">Available</td>
                        <td class="highlight-green">Available</td>
                        <td class="highlight-red">Not Available</td>
                        <td class="highlight-green">Available</td>
                        <td>—</td>
                        <td>—</td>
                        <td>—</td>
                    </tr>
                </tbody>
            </table>
            
            <div class="calculation-box">
                <div class="calculation-title">Example: Team 1 Press Eligibility Check (Hole 6)</div>
                <ul class="step-list">
                    <li><strong>vs Team 2 - Front 9:</strong> Team 1 down by 2 holes → ✅ Eligible to press</li>
                    <li><strong>vs Team 2 - Back 9:</strong> Not yet started → ❌ Not eligible</li>
                    <li><strong>vs Team 2 - Total 18:</strong> Team 1 down by 1 hole → ✅ Eligible to press</li>
                    <li><strong>vs Team 3 - Front 9:</strong> Team 1 up by 1 hole → ❌ Not eligible</li>
                    <li><strong>vs Team 3 - Total 18:</strong> Team 1 even → ❌ Not eligible</li>
                </ul>
            </div>
            
            <div class="section-header">🔄 Dynamic Eligibility Changes</div>
            
            <table class="sheet-table">
                <thead>
                    <tr>
                        <th>Hole</th>
                        <th>Event</th>
                        <th>New Eligibility</th>
                        <th>Available Press Options</th>
                        <th>UI Action Required</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>5</td>
                        <td>Team 1 loses hole vs Team 2</td>
                        <td>Team 1 now down by 2 in Front 9</td>
                        <td class="highlight-green">Team 1 can press Team 2 (Front 9)</td>
                        <td>Show press opportunity</td>
                    </tr>
                    <tr>
                        <td>6</td>
                        <td>Team 3 loses hole vs Team 1</td>
                        <td>Team 3 now down by 2 in Total 18</td>
                        <td class="highlight-green">Team 3 can press Team 1 (Total 18)</td>
                        <td>Show press opportunity</td>
                    </tr>
                    <tr>
                        <td>7</td>
                        <td>Team 1 wins hole vs Team 2</td>
                        <td>Team 1 now down by 1 in Front 9</td>
                        <td class="highlight-red">Team 1 can no longer press Team 2 (Front 9)</td>
                        <td>Remove press opportunity</td>
                    </tr>
                    <tr>
                        <td>10</td>
                        <td>Start of Back 9</td>
                        <td>Back 9 eligibility now active</td>
                        <td class="highlight-green">All Back 9 press options available</td>
                        <td>Enable Back 9 press options</td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <!-- Example Situations Tab -->
        <div id="examples" class="tab-content">
            <div class="section-header">📝 Real-World Example Situations</div>
            
            <div class="calculation-box">
                <div class="calculation-title">Example 1: Complex Mixed Standings (Hole 6)</div>
                <table class="sheet-table">
                    <thead>
                        <tr>
                            <th>Team Matchup</th>
                            <th>Front 9 Status</th>
                            <th>Total 18 Status</th>
                            <th>Press Opportunities</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Team 1 vs Team 2</td>
                            <td class="highlight-red">Team 1 down by 2</td>
                            <td class="highlight-yellow">Team 1 down by 1</td>
                            <td class="highlight-green">T1 can press T2 (Front 9, Total 18)</td>
                        </tr>
                        <tr>
                            <td>Team 1 vs Team 3</td>
                            <td class="highlight-green">Team 1 up by 1</td>
                            <td class="highlight-blue">Even</td>
                            <td class="highlight-red">No press opportunities</td>
                        </tr>
                        <tr>
                            <td>Team 2 vs Team 3</td>
                            <td class="highlight-green">Team 2 up by 3</td>
                            <td class="highlight-green">Team 2 up by 2</td>
                            <td class="highlight-green">T3 can press T2 (Front 9, Total 18)</td>
                        </tr>
                    </tbody>
                </table>
                
                <p><strong>Press Modal Would Show:</strong></p>
                <ul class="step-list">
                    <li>Team 1: Can press Team 2 (Front 9, Total 18)</li>
                    <li>Team 3: Can press Team 2 (Front 9, Total 18)</li>
                    <li>Team 2: No press opportunities (up against both)</li>
                </ul>
            </div>
            
            <div class="calculation-box">
                <div class="calculation-title">Example 2: Multiple Active Presses (Hole 8)</div>
                <table class="sheet-table">
                    <thead>
                        <tr>
                            <th>Press ID</th>
                            <th>Pressing Team</th>
                            <th>Target Team</th>
                            <th>Game Type</th>
                            <th>Started on Hole</th>
                            <th>Current Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>P1</td>
                            <td class="team1-cell">Team 1</td>
                            <td class="team2-cell">Team 2</td>
                            <td>Front 9</td>
                            <td>5</td>
                            <td class="highlight-green">Team 1 up by 1</td>
                        </tr>
                        <tr>
                            <td>P2</td>
                            <td class="team3-cell">Team 3</td>
                            <td class="team2-cell">Team 2</td>
                            <td>Front 9</td>
                            <td>6</td>
                            <td class="highlight-blue">Even</td>
                        </tr>
                        <tr>
                            <td>P3</td>
                            <td class="team1-cell">Team 1</td>
                            <td class="team2-cell">Team 2</td>
                            <td>Total 18</td>
                            <td>7</td>
                            <td class="highlight-red">Team 1 down by 1</td>
                        </tr>
                    </tbody>
                </table>
                
                <p><strong>Complexity Analysis:</strong></p>
                <ul class="step-list">
                    <li>3 active presses between different team combinations</li>
                    <li>Team 1 has 2 active presses against Team 2 (different game types)</li>
                    <li>Hole 8 results will affect multiple press calculations</li>
                    <li>UI must track and display all 3 press statuses independently</li>
                </ul>
            </div>
            
            <div class="calculation-box">
                <div class="calculation-title">Example 3: Maximum Complexity Scenario (All Games Selected)</div>
                <p><strong>Situation:</strong> All three game types selected, multiple teams down in different games</p>
                
                <table class="sheet-table">
                    <thead>
                        <tr>
                            <th>Team</th>
                            <th>Available Press Targets</th>
                            <th>Game Types Available</th>
                            <th>Total Press Options</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="team1-cell">Team 1</td>
                            <td>Team 2, Team 3</td>
                            <td>Front 9, Total 18</td>
                            <td class="result-cell">4</td>
                        </tr>
                        <tr>
                            <td class="team2-cell">Team 2</td>
                            <td>Team 3</td>
                            <td>Back 9</td>
                            <td class="result-cell">1</td>
                        </tr>
                        <tr>
                            <td class="team3-cell">Team 3</td>
                            <td>Team 1, Team 2</td>
                            <td>Front 9, Back 9, Total 18</td>
                            <td class="result-cell">6</td>
                        </tr>
                    </tbody>
                </table>
                
                <p><strong>Total Current Press Opportunities:</strong> 4 + 1 + 6 = <strong>11 possible presses</strong></p>
                <p><strong>UI Challenge:</strong> Present 11 options clearly without overwhelming the user</p>
            </div>
        </div>
        
        <!-- Implementation Matrix Tab -->
        <div id="implementation" class="tab-content">
            <div class="section-header">⚙️ Backend Implementation Requirements</div>
            
            <table class="sheet-table">
                <thead>
                    <tr>
                        <th>Component</th>
                        <th>Complexity Level</th>
                        <th>Implementation Requirement</th>
                        <th>Data Structure</th>
                        <th>Performance Impact</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Team Relationship Tracking</td>
                        <td>Medium</td>
                        <td>6 relationship objects per match</td>
                        <td>Array of TeamRelationship objects</td>
                        <td>Low</td>
                    </tr>
                    <tr>
                        <td>Game Type Management</td>
                        <td>High</td>
                        <td>Dynamic game type selection with overlap handling</td>
                        <td>Set of HoleSelection enums</td>
                        <td>Medium</td>
                    </tr>
                    <tr>
                        <td>Press Eligibility Calculator</td>
                        <td>Very High</td>
                        <td>Real-time calculation for up to 18 combinations</td>
                        <td>Matrix calculation engine</td>
                        <td>High</td>
                    </tr>
                    <tr>
                        <td>Active Press Tracking</td>
                        <td>Very High</td>
                        <td>Up to 18 simultaneous active presses</td>
                        <td>Array of Press objects with status</td>
                        <td>High</td>
                    </tr>
                    <tr>
                        <td>UI State Management</td>
                        <td>Maximum</td>
                        <td>Dynamic eligibility updates per hole</td>
                        <td>Reactive state management</td>
                        <td>Very High</td>
                    </tr>
                </tbody>
            </table>
            
            <div class="section-header">📊 Performance Calculation Matrix</div>
            
            <table class="sheet-table">
                <thead>
                    <tr>
                        <th>Scenario</th>
                        <th>Max Possible Presses</th>
                        <th>Calculations per Hole</th>
                        <th>UI Updates per Hole</th>
                        <th>Memory Usage</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Single Game</td>
                        <td>6</td>
                        <td>18 (6 × 3 status checks)</td>
                        <td>6</td>
                        <td>Low</td>
                    </tr>
                    <tr>
                        <td>Two Games (No Overlap)</td>
                        <td>12</td>
                        <td>36 (12 × 3 status checks)</td>
                        <td>12</td>
                        <td>Medium</td>
                    </tr>
                    <tr>
                        <td>Two Games (Overlap)</td>
                        <td>12</td>
                        <td>48 (overlap complexity)</td>
                        <td>15</td>
                        <td>High</td>
                    </tr>
                    <tr>
                        <td>All Three Games</td>
                        <td>18</td>
                        <td>72 (18 × 4 complex checks)</td>
                        <td>25</td>
                        <td>Very High</td>
                    </tr>
                </tbody>
            </table>
            
            <div class="calculation-box">
                <div class="calculation-title">Optimization Strategies</div>
                <ul class="step-list">
                    <li><strong>Caching:</strong> Cache press eligibility calculations between holes</li>
                    <li><strong>Lazy Loading:</strong> Only calculate press options when modal is opened</li>
                    <li><strong>Debouncing:</strong> Debounce rapid score updates to reduce calculations</li>
                    <li><strong>Selective Updates:</strong> Only update affected relationships when scores change</li>
                    <li><strong>Background Processing:</strong> Calculate complex scenarios in background threads</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        function openTab(evt, tabName) {
            var i, tabcontent, tabs;
            tabcontent = document.getElementsByClassName("tab-content");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].classList.remove("active");
            }
            tabs = document.getElementsByClassName("tab");
            for (i = 0; i < tabs.length; i++) {
                tabs[i].classList.remove("active");
            }
            document.getElementById(tabName).classList.add("active");
            evt.currentTarget.classList.add("active");
        }
        
        function exportToCSV() {
            // Collect all table data
            let csvContent = "data:text/csv;charset=utf-8,";
            
            // Summary data
            csvContent += "3-Team Press Logic Analysis\\n\\n";
            csvContent += "Game Selection,Team Relationships,Number of Games,Calculation,Total Combinations,Overlap Type,Complexity\\n";
            csvContent += "Single Game,6,1,6×1,6,None,Low\\n";
            csvContent += "Front+Back,6,2,6×2,12,None,Medium\\n";
            csvContent += "Front+Total,6,2,6×2,12,Holes 1-9,High\\n";
            csvContent += "Back+Total,6,2,6×2,12,Holes 10-18,High\\n";
            csvContent += "All Three,6,3,6×3,18,Full Overlap,Maximum\\n\\n";
            
            // Team relationships
            csvContent += "Team Relationships\\n";
            csvContent += "ID,Pressing Team,Target Team,Code\\n";
            csvContent += "R1,Team 1,Team 2,T1→T2\\n";
            csvContent += "R2,Team 1,Team 3,T1→T3\\n";
            csvContent += "R3,Team 2,Team 1,T2→T1\\n";
            csvContent += "R4,Team 2,Team 3,T2→T3\\n";
            csvContent += "R5,Team 3,Team 1,T3→T1\\n";
            csvContent += "R6,Team 3,Team 2,T3→T2\\n";
            
            var encodedUri = encodeURI(csvContent);
            var link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "3-team-press-logic-analysis.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        function exportToExcel() {
            alert("Excel export functionality would require additional libraries. For now, use the CSV export and open in Excel.");
        }
    </script>
</body>
</html>